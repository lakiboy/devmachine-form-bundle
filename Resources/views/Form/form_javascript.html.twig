{% block devmachine_date_javascript %}
    <script type="text/javascript">
        $(function () {
            var config = {{ config | json_encode | raw }};

            {% if inline %}
                $('#{{ id }}-calendar').datepicker(config).on('changeDate', function () {
                    $('#{{ id }}').val($(this).datepicker('getFormattedDate'));
                });
            {% elseif input_addon %}
                $('#{{ id }}-container').datepicker(config);
            {% else %}
                $('#{{ id }}').datepicker(config);
            {% endif %}
        });
    </script>
{% endblock %}

{% block devmachine_datetime_javascript %}
    <script type="text/javascript">
        $(function () {
            var config = {{ config | json_encode | raw }};

            {% if inline %}
                $('#{{ id }}-calendar').datetimepicker(config).on('dp.change', function () {
                    var dp = $(this).data('DateTimePicker');

                    // Get formatted date.
                    $('#{{ id }}').val(dp.date().format(dp.format()));
                });

                // Init current date time picker.
                if ($('#{{ id }}').val()) {
                    $('#{{ id }}-calendar').data('DateTimePicker').date($('#{{ id }}').val());
                }
            {% elseif input_addon %}
                $('#{{ id }}-container').datetimepicker(config);
            {% else %}
                $('#{{ id }}').datetimepicker(config);
            {% endif %}
        });
    </script>
{% endblock %}

{% block devmachine_child_choice_javascript %}
    <script type="text/javascript">
        $(function () {
            var $options = $('#{{ id }} optgroup').clone(),
                $parent  = $('#{{ form.parent.children[parent].vars.id }}'),
                $select  = $('#{{ id }}');
            ;

            $select.children('optgroup').remove();

            {% if select2 %}
                $select.select2();
            {% endif %}

            $parent.change(function () {
                {% if required or multiple %}
                    $select.children().remove();
                {% else %}
                    $select.children().slice(1).remove();
                {% endif %}

                {% if select2 %}
                    $select.select2('val', '');
                {% endif %}

                var $filtered = $options.filter('[label="' + $(this).val() + '"]').children().clone();

                $select.append($filtered).change();
            }).change();
        });
    </script>
{% endblock %}
